# Railway Impact Simulator

## HHT-Œ± Implicit Integration with Bouc-Wen Hysteresis

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Research: CC BY 4.0](https://img.shields.io/badge/Research-CC%20BY%204.0-lightgrey.svg)](https://creativecommons.org/licenses/by/4.0/)

---

## Copyright & License

**Software Copyright:**  
¬© 2025 Sebasti√°n Labb√©

**Software License:**  
MIT License - See [LICENSE](LICENSE) file for details

**Research Report License:**  
CC BY 4.0 - The underlying research is openly licensed

---

## Code Information

**Code Implementation & Maintainer:**  
Sebasti√°n Labb√©, Dipl.-Ing.  
Karlsruher Institut f√ºr Technologie (KIT)

**Based on Research Report:**  
DZSF Bericht 53 (2024)

---

## Research Background

This simulator implements the methodologies described in the comprehensive research project on impact loads from railway vehicles on structures.

### Report Title (German)
**√úberpr√ºfung und Anpassung der Anpralllasten aus dem Eisenbahnverkehr**

### Report Title (English)
**Review and Adjustment of Impact Loads from Railway Traffic**

---

## Research Authors

**Univ.-Prof. Dr.-Ing. Lothar Stempniewski**  
Karlsruher Institut f√ºr Technologie (KIT)  
Institut f√ºr Massivbau und Baustofftechnologie  
Abteilung Massivbau  
Gotthard-Franz-Stra√üe 3  
76131 Karlsruhe, Germany

**Dipl.-Ing. Sebasti√°n Labb√©**  
Karlsruher Institut f√ºr Technologie (KIT)  
Institut f√ºr Massivbau und Baustofftechnologie  
Abteilung Massivbau  
Gotthard-Franz-Stra√üe 3  
76131 Karlsruhe, Germany

**Dr.-Ing. Steffen Siegel**  
Siegel und W√ºnschel beratende Ingenieure  
Partnerschaftsgesellschaft mbB  
Zehntwiesenstra√üe 35a  
76275 Ettlingen, Germany

**Robin Bosch, M.Sc.**  
Siegel und W√ºnschel beratende Ingenieure  
Partnerschaftsgesellschaft mbB  
Zehntwiesenstra√üe 35a  
76275 Ettlingen, Germany

---

## Institutional Partners

### üèõÔ∏è Karlsruher Institut f√ºr Technologie (KIT)
**Institut f√ºr Massivbau und Baustofftechnologie**  
Abteilung Massivbau  
Gotthard-Franz-Stra√üe 3  
76131 Karlsruhe, Germany  
Website: https://www.ibb.kit.edu

### üè¢ Siegel und W√ºnschel
**Siegel und W√ºnschel beratende Ingenieure PartG mbB**  
Zehntwiesenstra√üe 35a  
76275 Ettlingen, Germany  
Website: https://www.siegel-wuenschel.de

---

## Commissioning and Publishing Organizations

### üöÜ Eisenbahn-Bundesamt (EBA)
**Federal Railway Authority**  
Heinemannstra√üe 6  
53175 Bonn, Germany  
Website: https://www.eba.bund.de

The Eisenbahn-Bundesamt is Germany's competent authority for railways, responsible for regulatory oversight, approval, and supervision of railway operations and infrastructure.

### üî¨ Deutsches Zentrum f√ºr Schienenverkehrsforschung (DZSF)
**German Centre for Rail Transport Research**  
August-Bebel-Stra√üe 10  
01219 Dresden, Germany  
Website: https://www.dzsf.bund.de

The DZSF coordinates and promotes rail transport research in Germany, focusing on innovation and technological advancement in the railway sector.

---

## Official Publication

### Research Report Details
**Series:** Berichte des Deutschen Zentrums f√ºr Schienenverkehrsforschung  
**Report Number:** Bericht 53 (2024)  
**Project Number:** 2018-08-U-1217  

**Study Completion:** June 2021  
**Publication Date:** June 2024  

**Publisher:**  
Deutsches Zentrum f√ºr Schienenverkehrsforschung  
beim Eisenbahn-Bundesamt  
August-Bebel-Stra√üe 10  
01219 Dresden, Germany

**Editorial Team:**  
Deutsches Zentrum f√ºr Schienenverkehrsforschung  
Markus Reinhardt, Martin Friese  
Fachbereich Digitalisierung und Technik

### Identifiers
**DOI:** [10.48755/dzsf.240006.01](https://doi.org/10.48755/dzsf.240006.01)  
**ISSN:** 2629-7973  
**License:** [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/)

### Download Link
**Official PDF:**  
[https://www.dzsf.bund.de/SharedDocs/Downloads/DZSF/Veroeffentlichungen/Forschungsberichte/2024/ForBe_53_2024_Anpralllasten.pdf](https://www.dzsf.bund.de/SharedDocs/Downloads/DZSF/Veroeffentlichungen/Forschungsberichte/2024/ForBe_53_2024_Anpralllasten.pdf?__blob=publicationFile&v=2)

---

## Citation

### Plain Text Citation
```
Stempniewski, L., Labb√©, S., Siegel, S., & Bosch, R. (2024).
√úberpr√ºfung und Anpassung der Anpralllasten aus dem Eisenbahnverkehr.
Berichte des Deutschen Zentrums f√ºr Schienenverkehrsforschung, Bericht 53.
Deutsches Zentrum f√ºr Schienenverkehrsforschung beim Eisenbahn-Bundesamt.
https://doi.org/10.48755/dzsf.240006.01
```

### BibTeX
```bibtex
@techreport{Stempniewski2024Anpralllasten,
  author       = {Stempniewski, Lothar and 
                  Labb√©, Sebasti√°n and 
                  Siegel, Steffen and 
                  Bosch, Robin},
  title        = {√úberpr√ºfung und Anpassung der Anpralllasten 
                  aus dem Eisenbahnverkehr},
  institution  = {Deutsches Zentrum f√ºr Schienenverkehrsforschung 
                  beim Eisenbahn-Bundesamt},
  year         = {2024},
  type         = {Bericht},
  number       = {53},
  address      = {Dresden, Germany},
  month        = {6},
  note         = {Projektnummer 2018-08-U-1217, 
                  Commissioned by Eisenbahn-Bundesamt, 
                  Study completed June 2021},
  doi          = {10.48755/dzsf.240006.01},
  issn         = {2629-7973},
  url          = {https://www.dzsf.bund.de/SharedDocs/Downloads/DZSF/Veroeffentlichungen/Forschungsberichte/2024/ForBe_53_2024_Anpralllasten.pdf}
}
```

### APA 7th Edition
```
Stempniewski, L., Labb√©, S., Siegel, S., & Bosch, R. (2024). 
√úberpr√ºfung und Anpassung der Anpralllasten aus dem Eisenbahnverkehr 
(DZSF Bericht No. 53). Deutsches Zentrum f√ºr Schienenverkehrsforschung 
beim Eisenbahn-Bundesamt. https://doi.org/10.48755/dzsf.240006.01
```

### RIS Format
```
TY  - RPRT
AU  - Stempniewski, Lothar
AU  - Labb√©, Sebasti√°n
AU  - Siegel, Steffen
AU  - Bosch, Robin
TI  - √úberpr√ºfung und Anpassung der Anpralllasten aus dem Eisenbahnverkehr
T2  - Berichte des Deutschen Zentrums f√ºr Schienenverkehrsforschung
PY  - 2024
DA  - 2024/06
IS  - 53
PB  - Deutsches Zentrum f√ºr Schienenverkehrsforschung beim Eisenbahn-Bundesamt
CY  - Dresden, Germany
DO  - 10.48755/dzsf.240006.01
SN  - 2629-7973
UR  - https://www.dzsf.bund.de/SharedDocs/Downloads/DZSF/Veroeffentlichungen/Forschungsberichte/2024/ForBe_53_2024_Anpralllasten.pdf
ER  -
```

---

## Technical Background

### Simulation Method
The simulator implements the **HHT-Œ± (Hilber-Hughes-Taylor-Œ±)** implicit time integration method, which provides:
- Numerical stability for stiff systems
- Controllable numerical damping via the Œ± parameter
- Second-order accuracy
- Energy conservation properties

### Material Model
**Bouc-Wen Hysteresis Model** is employed to capture:
- Nonlinear force-displacement relationships
- Cyclic loading behavior
- Energy dissipation during impact
- Realistic material response under extreme loading

### Contact Models
Multiple impact/contact models are implemented:
- **Anagnostopoulos (1988)** - Linear viscoelastic (Kelvin-Voigt) model for structural pounding
- **Hooke** - Linear elastic
- **Hertz** - Nonlinear elastic (Hertzian contact)
- **Hunt-Crossley (1975)** - Hertz with velocity-dependent damping
- **Lankarani-Nikravesh (1990)** - Modified Hunt-Crossley with hysteresis
- **Flores et al. (2006)** - Energy-based dissipation model
- **Gonthier et al. (2004)** - Compliant contact with restitution
- **Ye et al. (2009)** - Linear spring with damping
- **Pant-Wijeyewickrema (2012)** - Enhanced linear damping model

**Key Reference:**
- Anagnostopoulos, S.A. (1988). "Pounding of buildings in series during earthquakes." 
  *Earthquake Engineering & Structural Dynamics*, 16(3), 443-456. 
  DOI: [10.1002/eqe.4290160311](https://doi.org/10.1002/eqe.4290160311)

### Friction Models
Available friction formulations:
- LuGre (Dynamic friction with bristle model)
- Dahl (Rate-dependent friction)
- Coulomb-Stribeck (Classical friction)
- Brown-McPhee (Smooth approximation)

---

## Validation

The simulator has been validated against experimental crash test data:

### Pioneer Wagon Crash Test (FRA, 1999)

**Test Configuration:**
- Single passenger wagon (40 tons, 23 m length)
- Rigid wall impact at 56.32 km/h (35 mph)
- Full-scale experimental test data available

**Validation Results:**
- ‚úÖ Peak acceleration: Within 20% of experimental data
- ‚úÖ Impact duration: Good agreement with test
- ‚úÖ Energy dissipation: Reasonable approximation
- ‚úÖ Force-displacement behavior: Matches expected hysteresis

**Default 7-Mass Research Model:**
The default configuration in the simulator corresponds to this validated Pioneer wagon case:
- Positions: [1.5, 4.5, 8.0, 11.5, 15.0, 18.5, 21.5] m
- Masses: [4, 10, 4, 4, 4, 10, 4] tons
- Spring properties: Fy = 15 MN, uy = 200 mm
- Wall stiffness: 45 MN/m

**Detailed Validation Report:**  
See [VALIDATION_Pioneer.md](VALIDATION_Pioneer.md) for complete validation documentation including:
- Experimental test details
- Model parameters
- Expected results
- Acceptance criteria
- Known limitations

**References:**
- Tyrell, D., et al. (1999). "Federal Railroad Administration full-scale crash tests."
- Kirkpatrick, S.W., et al. (2000). "Development and validation of high fidelity vehicle crash simulation models."
- Labb√©, S. "A Discrete Model for the Prediction of Impact Loads from Railway Traffic." KIT Dissertation.

---

## Software Information

### Requirements
```bash
pip install streamlit>=1.28.0
pip install numpy>=1.24.0
pip install pandas>=2.0.0
pip install scipy>=1.10.0
pip install plotly>=5.14.0
pip install xlsxwriter>=3.0.0
pip install openpyxl>=3.1.0
```

### Running the Simulator
```bash
# From command line
streamlit run railway_impact_simulator_refactored.py

# Or access via web browser
# The app will automatically open at http://localhost:8501
```

### Features
- ‚úÖ Interactive parameter configuration
- ‚úÖ Real-time simulation visualization
- ‚úÖ Multiple train configurations (research locomotive, passenger trains, freight)
- ‚úÖ Various material and contact models
- ‚úÖ Export results (CSV, TXT, XLSX)
- ‚úÖ Force-time, penetration-time, and hysteresis plots

---

## Applications

This research and simulator are relevant for:

1. **Railway Infrastructure Design**
   - Bridge abutment protection
   - Tunnel portal design
   - Platform edge barriers

2. **Safety Analysis**
   - Derailment scenarios
   - Impact protection systems
   - Emergency stop barriers

3. **Standards Development**
   - Impact load specifications
   - Design code recommendations
   - Safety factor determination

4. **Research & Education**
   - Structural dynamics studies
   - Material behavior under impact
   - Numerical methods validation

---

## License

[To be specified by the research institutions]

---

## Contact

### Software/Code Questions
**Sebasti√°n Labb√©, Dipl.-Ing.**  
Karlsruher Institut f√ºr Technologie (KIT)  
Institut f√ºr Massivbau und Baustofftechnologie  
Gotthard-Franz-Stra√üe 3  
76131 Karlsruhe, Germany  
Email: [your email if you want to include it]

### For Technical Questions about the Research Report
**Karlsruher Institut f√ºr Technologie (KIT)**  
Institut f√ºr Massivbau und Baustofftechnologie  
Gotthard-Franz-Stra√üe 3  
76131 Karlsruhe, Germany  
Website: https://www.ibb.kit.edu

**Siegel und W√ºnschel**  
Zehntwiesenstra√üe 35a  
76275 Ettlingen, Germany  
Website: https://www.siegel-wuenschel.de

### For DZSF Research Program Information
**Deutsches Zentrum f√ºr Schienenverkehrsforschung**  
August-Bebel-Stra√üe 10  
01219 Dresden, Germany  
Email: info@dzsf.bund.de  
Website: https://www.dzsf.bund.de

### For Regulatory/Practical Applications
**Eisenbahn-Bundesamt (EBA)**  
Heinemannstra√üe 6  
53175 Bonn, Germany  
Website: https://www.eba.bund.de  
Contact: https://www.eba.bund.de/DE/Service/Kontakt/kontakt_node.html

---

## Acknowledgments

**Software Development:**  
This software was developed by Sebasti√°n Labb√© at the Karlsruher Institut f√ºr 
Technologie (KIT) as an implementation of the methodologies described in the 
DZSF research report.

**Research Foundation:**  
The underlying research was commissioned by the **Eisenbahn-Bundesamt (EBA)** 
and published by the **Deutsches Zentrum f√ºr Schienenverkehrsforschung (DZSF)**.

The research was conducted by:
- Karlsruher Institut f√ºr Technologie (KIT)
- Siegel und W√ºnschel beratende Ingenieure PartG mbB

**Project Number:** 2018-08-U-1217  
**Study Completion:** June 2021  
**Publication:** June 2024

---

## License

### Software License (Code Implementation)

**MIT License**

Copyright (c) 2025 Sebasti√°n Labb√©

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

### Research Report License

**CC BY 4.0** - Creative Commons Attribution 4.0 International

The underlying research report is openly licensed:  
https://creativecommons.org/licenses/by/4.0/

You are free to:
- ‚úÖ Share and redistribute
- ‚úÖ Adapt and build upon
- ‚úÖ Use commercially

You must:
- üìå Give appropriate credit (cite the report)
- üîó Provide a link to the license
- üìù Indicate if changes were made

---

## Scientific References

### Primary Research Report
Stempniewski, L., Labb√©, S., Siegel, S., & Bosch, R. (2024). "√úberpr√ºfung und Anpassung der Anpralllasten aus dem Eisenbahnverkehr." *Berichte des Deutschen Zentrums f√ºr Schienenverkehrsforschung*, Bericht 53. DOI: [10.48755/dzsf.240006.01](https://doi.org/10.48755/dzsf.240006.01)

### Contact/Impact Models

**Anagnostopoulos Linear Viscoelastic Model:**
- Anagnostopoulos, S.A. (1988). "Pounding of buildings in series during earthquakes." *Earthquake Engineering & Structural Dynamics*, 16(3), 443-456. DOI: [10.1002/eqe.4290160311](https://doi.org/10.1002/eqe.4290160311)
- Anagnostopoulos, S.A. (2004). "Equivalent viscous damping for modeling inelastic impacts in earthquake pounding problems." *Earthquake Engineering & Structural Dynamics*, 33(8), 897-902. DOI: [10.1002/eqe.377](https://doi.org/10.1002/eqe.377)

**Hertzian and Modified Contact Models:**
- Hunt, K.H., & Crossley, F.R.E. (1975). "Coefficient of restitution interpreted as damping in vibroimpact." *ASME Journal of Applied Mechanics*, 42, 440-445.
- Lankarani, H.M., & Nikravesh, P.E. (1990). "A contact force model with hysteresis damping for impact analysis of multibody systems." *Journal of Mechanical Design*, 112(3), 369-376.
- Muthukumar, S., & DesRoches, R. (2006). "A Hertz contact model with non-linear damping for pounding simulation." *Earthquake Engineering & Structural Dynamics*, 35(7), 811-828. DOI: [10.1002/eqe.557](https://doi.org/10.1002/eqe.557)

**Other Contact Models:**
- Ye, K., Li, L., & Zhu, H. (2009). "A note on the Hertz contact model with nonlinear damping for pounding simulation." *Earthquake Engineering & Structural Dynamics*, 38(9), 1135-1142.
- Pant, D.R., & Wijeyewickrema, A.C. (2012). "Structural performance of a base-isolated reinforced concrete building subjected to seismic pounding." *Earthquake Engineering & Structural Dynamics*, 41(12), 1709-1716.

### Friction Models

**LuGre Model:**
- Canudas de Wit, C., Olsson, H., √Östr√∂m, K.J., & Lischinsky, P. (1995). "A new model for control of systems with friction." *IEEE Transactions on Automatic Control*, 40(3), 419-425.

**Dahl Model:**
- Dahl, P.R. (1968). "A solid friction model." *The Aerospace Corporation*, TOR-0158(3107-18)-1.

### Numerical Integration & Hysteresis

**HHT-Œ± Method:**
- Hilber, H.M., Hughes, T.J.R., & Taylor, R.L. (1977). "Improved numerical dissipation for time integration algorithms in structural dynamics." *Earthquake Engineering & Structural Dynamics*, 5(3), 283-292.

**Bouc-Wen Model:**
- Bouc, R. (1967). "Forced vibration of mechanical systems with hysteresis." *Proceedings of the Fourth Conference on Nonlinear Oscillation*, Prague, Czechoslovakia.
- Wen, Y.K. (1976). "Method for random vibration of hysteretic systems." *Journal of the Engineering Mechanics Division*, 102(2), 249-263.

---

## Attribution & Citation

When using this software, please provide attribution in two ways:

### 1. Software Citation (Code)
```
Labb√©, S. (2025). Railway Impact Simulator: HHT-Œ± Implicit Integration 
with Bouc-Wen Hysteresis [Computer software]. 
https://github.com/[your-repo] (or appropriate link)
```

### 2. Research Report Citation (Methodology)
```
Stempniewski, L., Labb√©, S., Siegel, S., & Bosch, R. (2024).
√úberpr√ºfung und Anpassung der Anpralllasten aus dem Eisenbahnverkehr.
Berichte des Deutschen Zentrums f√ºr Schienenverkehrsforschung, Bericht 53.
Deutsches Zentrum f√ºr Schienenverkehrsforschung beim Eisenbahn-Bundesamt.
https://doi.org/10.48755/dzsf.240006.01
```

---

**Software ¬© 2025 Sebasti√°n Labb√©** (MIT License)  
**Research ¬© 2024 Karlsruher Institut f√ºr Technologie, Siegel und W√ºnschel PartG mbB** (CC BY 4.0)

*Research commissioned by Eisenbahn-Bundesamt (EBA)*  
*Published by Deutsches Zentrum f√ºr Schienenverkehrsforschung (DZSF)*

---

**Disclaimer:** The responsibility for the content of the research publication lies 
with the research authors. This software implementation is provided "as is" without 
warranty. For safety-critical applications, consult qualified professional engineers.

*Die Verantwortung f√ºr den Inhalt der Forschungsver√∂ffentlichung liegt bei den 
Autorinnen und Autoren. Diese Softwareimplementierung wird ohne Gew√§hrleistung 
bereitgestellt.*
